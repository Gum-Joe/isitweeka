{"version":3,"sources":["utils/gAnalytics.ts","utils/scroll.ts","components/Button.Forward.tsx","components/EventsList.tsx","components/EventRow.tsx","components/SiteContainer.tsx","components/Tabs/TabRow.tsx","components/Tabs/Tab.tsx","components/Tabs/Container.tsx","utils/constants.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["GA_DISABLE_COOKIE_STR","gaSetState","state","document","cookie","window","scrollDown","scrollTo","top","innerHeight","behavior","scrollUp","Button","props","className","children","displayName","EventTypes","baseEventImageStyle","backgroundSize","backgroundRepeat","backgroundPosition","display","flex","margin","width","maxHeight","EventRow","style","backgroundColor","this","background","backgroundImage","imageURL","title","Date","saleDate","valueOf","now","href","ticketsURL","React","PureComponent","toISOString","EventsList","onClick","eventData","events","map","index","headerURL","ticketsSale","start","Component","SiteContainer","isNotWeekAB","week","apiHasRan","isWeekend","generatedAt","getCalendar","fetchEvents","err","console","error","message","setState","dummyResponse","d","dhere","day","getDay","diff","getDate","setDate","goTo","forwardList","includes","inputDate","weekStart","forwardOrRewindToDay","weekMarkerDate","setUTCHours","weekEnd","dayNow","startTime","fetch","calendarURL","method","mode","credentials","baseResponse","text","ics","data","ical","Map","Object","entries","forEach","v","key","delete","entry","summary","theEvent","size","marginRight","getStatus","TabRow","Tab","active","TabContainer","useState","initialTab","activeTab","setTab","afterTabChange","tab","onTabChange","useEffect","tabs","component","COOKIE_SCHOOL_PREFERENCE","App","Cookies","get","set","school","tabIndex","secure","sameSite","gtag","log","updateCookie","getJSON","Navbar","fixed","enableDeclineButton","flipButtons","buttonText","declineButtonText","onAccept","location","reload","onDecline","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.8cc66933.chunk.js","sourcesContent":["// Set to the same value as the web property used on the site\nexport const GA_PROPERTY = \"G-X4VMSWGN74\";\n\n/** \n * Disable tracking if the opt-out cookie exists.\n * Also opts out of preferences\n */\nexport const GA_DISABLE_COOKIE_STR = \"ga-disable-\" + GA_PROPERTY;\n/*if (document.cookie.indexOf(disableStr + '=true') > -1) {\n\t// @ts-ignore\n\twindow[disableStr] = true;\n}*/\n\n// Opt-out function\n/** Use true to opt out */\nexport default function gaSetState(state: boolean): void {\n\tdocument.cookie = GA_DISABLE_COOKIE_STR + `=${state ? \"true\" : \"false\"}; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/`;\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\twindow[GA_DISABLE_COOKIE_STR] = state;\n}","/**\n * Useful utils to scroll up and down the page\n * @packageDocumentation\n */\n\nexport function scrollDown(): void {\n\twindow.scrollTo({\n\t\ttop: window.innerHeight,\n\t\tbehavior: \"smooth\",\n\t});\n}\n\nexport function scrollUp(): void {\n\twindow.scrollTo({\n\t\ttop: 0,\n\t\tbehavior: \"smooth\",\n\t});\n}","import React from \"react\";\n\nconst Button = (props: React.ButtonHTMLAttributes<any>) => {\n\treturn (\n\t\t<button {...props} className=\"forward\">\n\t\t\t<span>{props.children}</span>\n\t\t</button>\n\t);\n};\n\nButton.displayName = \"Button.Forward\";\n\nexport default Button;","import React, { Component } from \"react\";\nimport { scrollUp, scrollDown } from \"../utils/scroll\";\nimport EventRow from \"./EventRow\";\n\n/**\n * Used to distinguish between the different type of event we can display.\n */\nexport enum EventTypes{\n\tHOUSE = \"house\", // house event\n\tCHARITY = \"charity\", // charity event\n} \n\nexport interface EventItem {\n\ttitle: string;\n\t// HACK: So that it won't complain about the JSON. Please remove eventually\n\teventType: EventTypes | string;\n\tticketsURL: string;\n\tticketsSale: {\n\t\tstart: string;\n\t\tend?: string;\n\t};\n\theaderURL: string;\n\tbackgroundColor: string;\n}\n\nexport interface EventData {\n\tevents: Array<EventItem>;\n\tgeneratedAt: string; // Timestamp\n}\n\n/**\n * @deprecated Use the JSON file in `src` insted.\n */\nexport const dummyResponse: EventData = {\n\tevents: [\n\t\t{\n\t\t\ttitle: \"Would I Lie To You?\",\n\t\t\tticketsURL: \"https://www.eventbrite.co.uk/e/would-i-lie-to-you-students-vs-teachers-tickets-133890123965?aff=isitweeka\",\n\t\t\theaderURL: \"/Logo_Export_Trans_but_not_on_HRT.png\",\n\t\t\tbackgroundColor: \"#2C1F39\",\n\t\t\tticketsSale: {\n\t\t\t\tstart: \"1/1/2020\",\n\t\t\t},\n\t\t\teventType: \"charity\"\n\t\t}\n\t],\n\tgeneratedAt: new Date().toISOString(),\n};\n\n/**\n * Fetched events list that follows {@link EventData} that is to be displayed\n * @see EventData\n */\nexport interface EventsListProps {\n\teventData: EventData;\n}\n\n/**\n * List events based off inputted JSON\n * Eventually it will take a URL that a\n */\nexport default class EventsList extends Component<EventsListProps> {\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"isitweeka events\">\n\t\t\t\t<h2><button onClick={scrollUp} className=\"back\" /> Upcoming Events</h2>\n\t\t\t\t<div className=\"events-list\">\n\t\t\t\t\t{this.props.eventData.events.map(({ title, headerURL, backgroundColor, ticketsSale, ticketsURL }, index) => (\n\t\t\t\t\t\t<EventRow\n\t\t\t\t\t\t\timageURL={headerURL}\n\t\t\t\t\t\t\ttitle={title}\n\t\t\t\t\t\t\tsaleDate={ticketsSale.start}\n\t\t\t\t\t\t\tticketsURL={ticketsURL}\n\t\t\t\t\t\t\tbackground={backgroundColor}\n\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))}\n\t\t\t\t\t{/*<div className=\"events-row\">*/}\n\t\t\t\t\t{/*\t<div style={{ ...baseEventImageStyle }}>*/}\n\t\t\t\t\t{/*\t  <h4>[IMAGE SET AS BACKGROUND OF THIS DIV]</h4>*/}\n\t\t\t\t\t{/*\t</div>*/}\n\t\t\t\t\t{/*\t<div>*/}\n\t\t\t\t\t{/*\t  <h3>Event Number Two?</h3>*/}\n\t\t\t\t\t{/*\t  <h4>Tickets on sale 03/02/21</h4>*/}\n\t\t\t\t\t{/*\t</div>*/}\n\t\t\t\t\t{/*</div>*/}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}","import React from \"react\";\nimport Button from \"./Button.Forward\";\n\nconst baseEventImageStyle = {\n\tbackgroundSize: \"contain\",\n\tbackgroundRepeat: \"no-repeat\",\n\tbackgroundPosition: \"center\",\n\tdisplay: \"flex\",\n\tflex: 1,\n\tmargin: \"auto\",\n\twidth: \"90%\",\n\tmaxHeight: \"80%\",\n};\n\ninterface RowProps {\n\timageURL: string;\n\ttitle: string;\n\tsaleDate: string;\n\tbackground: string;\n\tticketsOnSale?: boolean;\n\tticketsURL: string;\n}\n\nexport default class EventRow extends React.PureComponent<RowProps, never> {\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"events-row\" style={{ backgroundColor: this.props.background }}>\n\t\t\t\t<div>\n\t\t\t\t\t<div style={{ backgroundImage: `url(${this.props.imageURL})`, ...baseEventImageStyle }}>\n\t\t\t\t\t\t{/*<h4>[IMAGE SET AS BACKGROUND OF THIS DIV]</h4>*/}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<h3>{this.props.title}</h3>\n\t\t\t\t\t{new Date(this.props.saleDate).valueOf() < Date.now() ? <a href={this.props.ticketsURL}><Button>Buy Tickets</Button></a> : null}\n\t\t\t\t\t<h4>Tickets on sale {this.props.saleDate}</h4>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}","import React, { Component } from \"react\";\nimport EventsList, { EventData } from \"./EventsList\";\nimport Button from \"./Button.Forward\";\nimport dummyResponse from \"../events.json\";\nimport { GregorianDay } from \"../utils/constants\";\nimport { scrollUp, scrollDown } from \"../utils/scroll\";\nimport * as ical from \"ical\";\n\n/**\n * Props to provide to the site\n */\nexport interface SiteProps {\n\t/** Calendar to fetch events from, e.g. `calendar@camphillboys.bham.sch.uk` */\n\tcalendarURL: string;\n\t/** Day of the Week A/B event that marks a week as being A/B, 0-6, where 0 is Sunday */\n\tweekMarkerDate: GregorianDay;\n}\n\nconst baseEventImageStyle = {\n\tbackgroundSize: \"contain\",\n\tbackgroundRepeat: \"no-repeat\",\n\tbackgroundPosition: \"center\",\n\tdisplay: \"flex\",\n\tflex: 1,\n\tmargin: \"auto\",\n\twidth: \"90%\",\n\tmaxHeight: \"80%\",\n};\n\ninterface TheState {\n\t/** Set to true if neither Week A or B is detected */\n\tisNotWeekAB: boolean;\n\tweek: \"A\" | \"B\" | \"unknown\";\n\t/** Tells page when API has ran  (i.e. page loaded) */\n\tapiHasRan: boolean;\n\tisWeekend: boolean;\n\teventData: EventData;\n}\n\n/**\n * Contains the site of isitweeka.com itself.\n * They way, we can easily create variations of it for e.g. different school\n */\nexport default class SiteContainer extends Component<SiteProps, TheState> {\n\n\tconstructor(props: SiteProps) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tisNotWeekAB: false,\n\t\t\tweek: \"unknown\",\n\t\t\tapiHasRan: false,\n\t\t\tisWeekend: false,\n\t\t\teventData: {\n\t\t\t\tevents: [],\n\t\t\t\tgeneratedAt: \"\",\n\t\t\t},\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\ttry {\n\t\t\tthis.getCalendar();\n\t\t\tthis.fetchEvents();\n\t\t} catch (err) {\n\t\t\tconsole.error(\"Error: \" + err?.message);\n\t\t}\n\t}\n\n\tasync fetchEvents() {\n\t\t// TODO: Add real fetch logic, likely based on an inputted URL\n\t\tthis.setState({\n\t\t\teventData: dummyResponse,\n\t\t});\n\t}\n\n\t/**\n\t * Gets the monday from a week\n\t * From https://stackoverflow.com/questions/4156434/javascript-get-the-first-day-of-the-week-from-current-date\n\t * @deprecated Use {@link forwardOrRewindToDay} instead\n\t */\n\tgetMonday(d: Date) {\n\t\tconst dhere = new Date(d);\n\t\tconst day = dhere.getDay();\n\t\t// Sunday is day 0\n\t\t// Sat is Day 6\n\t\t// If Sun or Sat go to next week\n\t\t/**\n\t\t * What this does is:\n\t\t * - Take the current date\n\t\t * - Subtract the day of the week, taking us to the previous Sunday\n\t\t * - Go forward one to monday\n\t\t * - BUT if the current date is a Saturday, add 8 instead as we want 2 days after that Saturday (the next week), not the previous Monday\n\t\t */\n\t\tconst diff = dhere.getDate() - day + (day === 6 ? 8 : 1); // adjust when day is saturday -> add 6 to bring us back to Saturday, then add 2 to go to Monday\n\t\treturn new Date(dhere.setDate(diff));\n\t}\n\n\t/**\n\t * Go back to the first of a given day during a week, or to the next of the day for forwardList\n\t * Based on https://stackoverflow.com/questions/4156434/javascript-get-the-first-day-of-the-week-from-current-date\n\t * @param d Date object representing the day to 'rewind'\n\t * @param goTo Day number (0-6, 0 = Sunday) to go to\n\t * @param forwardList List of day numbers to forward to `goTo` (instead of backwards).\n\t */\n\tforwardOrRewindToDay(d: Date, goTo: GregorianDay, forwardList: number[]) {\n\t\tconst dhere = new Date(d);\n\t\tconst day = dhere.getDay();\n\t\t// Sunday is day 0\n\t\t// Sat is Day 6\n\t\t// If Sun or Sat go to next week\n\t\t/**\n\t\t * What this does is:\n\t\t * - Take the current date\n\t\t * - Subtract the day of the week, taking us to the previous Sunday\n\t\t * - Go forward by goTo days to the day we want (works as goTo is effectivly a \"Sunday offset\")\n\t\t * - BUT if the current date is in the forward list, add 7 as well to go forward 1 week\n\t\t */\n\t\tconst diff = dhere.getDate() - day + goTo + (forwardList.includes(day) ? 7 : 0); // adjust when day is saturday -> add 6 to bring us back to Saturday, then add 2 to go to Monday\n\t\treturn new Date(dhere.setDate(diff));\n\t}\n\n\t/**\n\t * Loads the KECHB calendar, finds the current week, then goes to the Monday of that week and checks for a Week A or Week B event.\n\t */\n\tasync getCalendar() {\n\t\tconst inputDate = new Date();\n\t\t// Used for fiddling:\n\t\t// inputDate.setDate(1);\n\t\t// inputDate.setMonth(0);\n\t\t// inputDate.setFullYear(2021);\n\t\tconst weekStart = this.forwardOrRewindToDay(inputDate, this.props.weekMarkerDate, [0, 6]);\n\t\tweekStart.setUTCHours(0, 0, 0, 0); // Set to start of day\n\t\tconst weekEnd = new Date(weekStart);\n\t\tweekEnd.setDate(weekEnd.getDate() + 1);\n\t\tweekEnd.setUTCHours(0, 0, 0, 0); // Set to start of day\n\n\t\t// Tell us if weekend!\n\t\tconst dayNow = inputDate.getDay();\n\t\tif (dayNow === 6 || dayNow === 0) { // 0 is Sunday, 6 is Saturday\n\t\t\tthis.setState({\n\t\t\t\tisWeekend: true,\n\t\t\t});\n\t\t}\n\n\t\tconst startTime = weekStart.toISOString();\n\t\tconst endTime = weekEnd.toISOString();\n\n\t\tconst baseResponse = await fetch(this.props.calendarURL, {\n\t\t\tmethod: \"GET\",\n\t\t\tmode: \"no-cors\",\n\t\t\tcredentials: \"same-origin\",\n\t\t});\n\n\t\tconst ics = await baseResponse.text();\n\n\t\t// console.log(ics);\n\n\t\tconst data = ical.parseICS(ics);\n\n\t\t// console.log(data);\n\n\t\tconst map = new Map(Object.entries(data));\n\n\t\tmap.forEach((v, key) => {\n\t\t\tif (v.start?.toISOString() !== startTime) {\n\t\t\t\tmap.delete(key);\n\t\t\t}\n\t\t});\n\n\t\t// Filter events to those that are \"Week A\" or \"Week B\"\n\t\tlet theEvent: ical.CalendarComponent | undefined;\n\t\tmap.forEach((entry, key) => {\n\t\t\tif (entry.summary === \"Week A\" || entry.summary === \"Week B\") {\n\t\t\t\ttheEvent = entry;\n\t\t\t} else {\n\t\t\t\tmap.delete(key);\n\t\t\t}\n\t\t});\n\t\tif (map.size === 0 || !theEvent) {\n\t\t\t// Neither detected.  Probably Hols.\n\t\t\tthis.setState({\n\t\t\t\tisNotWeekAB: true,\n\t\t\t\tweek: \"unknown\",\n\t\t\t\tapiHasRan: true,\n\t\t\t});\n\t\t} else {\n\t\t\t// const theEvent = eventsToday[0];\n\t\t\tswitch (theEvent.summary) {\n\t\t\t\tcase \"Week A\":\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tweek: \"A\",\n\t\t\t\t\t\tapiHasRan: true,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Week B\":\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tweek: \"B\",\n\t\t\t\t\t\tapiHasRan: true,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t// NEITHER!\n\t\t\t\t\t// Something went wrong\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tisNotWeekAB: true,\n\t\t\t\t\t\tapiHasRan: true,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Used to get what to display as the jumbotron, i.e. is it Week A, B or neither?\n\t */\n\tgetStatus() {\n\t\tif (this.state.isNotWeekAB || this.state.week === \"unknown\") {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<h2>It is neither Week A nor B.</h2>\n\t\t\t\t\t<h3>This means it&#39;s probably a holiday.</h3>\n\t\t\t\t\t<Button style={{ marginRight: \"auto\" }} className=\"forward\" onClick={scrollDown}><div>events</div></Button>\n\t\t\t\t\t<h5>If you believe this is in error, please email&nbsp;<a href=\"mailto:info@isitweeka.com\">info@isitweeka.com</a></h5>\n\t\t\t\t</>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<h2>{this.state.isWeekend ? \"Next week will be\" : \"It is\"}</h2> {/* Special case for weekend, where we show next week*/}\n\t\t\t\t\t<h1>Week {this.state.week}</h1>\n\t\t\t\t\t<h4>More coming soon...</h4>\n\t\t\t\t\t<Button style={{ marginRight: \"auto\" }} className=\"forward\" onClick={scrollDown}>events</Button>\n\t\t\t\t</>\n\t\t\t);\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className=\"isitweeka isitweeka-jumbotron\">\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.state.apiHasRan ? this.getStatus() : (<h2>Loading...</h2>)\n\t\t\t\t\t}\n\t\t\t\t</div>\n\n\t\t\t\t<EventsList eventData={this.state.eventData} />\n\t\t\t</>\n\t\t);\n\t}\n}\n","import React from \"react\";\n\nexport const TabRow: React.FunctionComponent = (props) => {\n\treturn (\n\t\t<div className=\"r-tab-row\">\n\t\t\t{props.children}\n\t\t</div>\n\t);\n};","import React from \"react\";\n\ninterface Props {\n\tonClick?: () => any;\n\tactive?: boolean;\n}\n\nexport const Tab: React.FunctionComponent<Props> = (props) => {\n\treturn (\n\t\t<button className={`r-tab${props.active ? \" active\" : \"\"}`} onClick={props.onClick}>\n\t\t\t<span>{props.children}</span>\n\t\t</button>\n\t);\n};","import React from \"react\";\nimport { TabRow } from \"./TabRow\";\nimport { Tabs } from \"./interfaces\";\nimport { Tab } from \"./Tab\";\n\ninterface Props {\n\ttabs: Tabs;\n\tinitialTab?: number;\n\t/**\n\t * Executed after a tab has changed.\n\t * @param tab Name of tab provided in `props.tabs`\n\t * @param index Index of tab\n\t */\n\tonTabChange?: (tab: string, index: number) => void;\n}\n\nexport const TabContainer: React.FunctionComponent<Props> = (props) => {\n\tconst [activeTab, setTab] = React.useState(props.initialTab || 0);\n\n\t/**\n\t * Used to execute `props.onTabChange` on the click of a tab\n\t */\n\tfunction afterTabChange(tab: string, index: number) {\n\t\tif (typeof props.onTabChange !== \"undefined\") {\n\t\t\tprops.onTabChange(tab, index);\n\t\t}\n\t}\n\n\t// Inital exection of it\n\tReact.useEffect(() => afterTabChange(props.tabs[activeTab].tab, activeTab));\n\n\treturn (\n\t\t<div className=\"r-tab-container\">\n\t\t\t<TabRow>\n\t\t\t\t{props.tabs.map(({ tab }, index) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Tab key={index} onClick={() => { setTab(index); afterTabChange(tab, index); }} active={activeTab === index}>{tab}</Tab>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</TabRow>\n\t\t\t<div>\n\t\t\t\t{props.tabs.map(({ component }, index) => {\n\t\t\t\t\treturn index === activeTab ? (\n\t\t\t\t\t\t<div key={index}>\n\t\t\t\t\t\t\t{component}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : null;\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\n","/** Type to represent a (Gregorian calendar!) day */\nexport type GregorianDay = 0 | 1 | 2 | 3 | 4 | 5 | 6; \n\n/** Name of Cookie used to store school preference */\nexport const COOKIE_SCHOOL_PREFERENCE = \"SchoolPreference\";","import React, { Component } from \"react\";\nimport gaSetState, { GA_DISABLE_COOKIE_STR, GA_PROPERTY } from \"./utils/gAnalytics\";\nimport \"./App.css\";\nimport CookieConsent from \"react-cookie-consent\";\nimport { EventData } from \"./components/EventsList\";\nimport dummyResponse from \"./events.json\";\nimport SiteContainer from \"./components/SiteContainer\";\nimport { TabContainer } from \"./components/Tabs\";\nimport { Navbar } from \"react-bootstrap\";\nimport Cookies from \"js-cookie\";\nimport { COOKIE_SCHOOL_PREFERENCE } from \"./utils/constants\";\n\n/*function App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <p>\n          Edit <code>src/App.tsx</code> and save to reload.\n        </p>\n        <a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Learn React\n        </a>\n      </header>\n    </div>\n  );\n}*/\n\ninterface TheState {\n  eventData: EventData;\n}\n\nclass App extends Component<Record<string, never>, TheState> {\n\n\tconstructor(props: Record<string, never>) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\teventData: {\n\t\t\t\tevents: [],\n\t\t\t\tgeneratedAt: \"\",\n\t\t\t}\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.fetchEvents();\n\t}\n\n\tasync fetchEvents() {\n\t\t// TODO: Add real fetch logic\n\t\tthis.setState({\n\t\t\teventData: dummyResponse,\n\t\t});\n\t}\n\n\t/**\n\t * Provided to TabContainer to update the cookie with whichever school the user has clicked\n\t * @param tab Tab name (so school name) from tabs list\n\t * @param index Tab index\n\t */\n\tupdateCookie(tab: string, index: number) {\n\t\t// ONLY set cookie if opt in set.\n\t\tif (Cookies.get(\"CookieConsent\") === \"true\") {\n\t\t\tCookies.set(COOKIE_SCHOOL_PREFERENCE, {\n\t\t\t\tschool: tab,\n\t\t\t\ttabIndex: index,\n\t\t\t}, {\n\t\t\t\tsecure: true,\n\t\t\t\tsameSite: \"strict\",\n\t\t\t});\n\n\t\t\t// Log this\n\t\t\tif (typeof gtag !== \"undefined\") {\n\t\t\t\tconsole.log(\"Setting to \" + tab);\n\t\t\t\tgtag(\"set\", \"user_properties\", {\n\t\t\t\t\tschool: tab\n\t\t\t\t});\n\t\t\t}\n\n\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"App\">\n\n\t\t\t\t<TabContainer tabs={[\n\t\t\t\t\t{\n\t\t\t\t\t\ttab: \"KECHB\",\n\t\t\t\t\t\tcomponent: (\n\t\t\t\t\t\t\t<SiteContainer\n\t\t\t\t\t\t\t\tcalendarURL=\"/cal/KECHB/basic.ics\"\n\t\t\t\t\t\t\t\tweekMarkerDate={1}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttab: \"KECHG\",\n\t\t\t\t\t\tcomponent: (\n\t\t\t\t\t\t\t<SiteContainer\n\t\t\t\t\t\t\t\tcalendarURL=\"/cal/KECHG/basic.ics\"\n\t\t\t\t\t\t\t\tweekMarkerDate={0}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t]} onTabChange={this.updateCookie} initialTab={(() => Cookies.getJSON(COOKIE_SCHOOL_PREFERENCE)?.tabIndex || 0)()}/>\n\n\t\t\t\t{/* Cookie consent */}\n\t\t\t\t<Navbar fixed=\"bottom\">\n\t\t\t\t<CookieConsent\n\t\t\t\t\tenableDeclineButton\n\t\t\t\t\t\tflipButtons\n\t\t\t\t\tbuttonText=\"I understand\"\n\t\t\t\t\tdeclineButtonText=\"No thanks\"\n\t\t\t\t\tonAccept={\n\t\t\t\t\t\t() => { gaSetState(false); window.location.reload(); }\n\t\t\t\t\t}\n\t\t\t\t\tonDecline={\n\t\t\t\t\t\t() => { gaSetState(true); window.location.reload(); }\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\tThis website uses cookies for preferences and analytics (via Google Analytics).\n\t\t\t\t\t\t<a href={process.env.PUBLIC_URL + \"/privacy.html\"}> View Privacy Policy</a>\n\t\t\t\t</CookieConsent>\n\t\t\t\t</Navbar>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default App;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n\tif (onPerfEntry && onPerfEntry instanceof Function) {\n\t\timport(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n\t\t\tgetCLS(onPerfEntry);\n\t\t\tgetFID(onPerfEntry);\n\t\t\tgetFCP(onPerfEntry);\n\t\t\tgetLCP(onPerfEntry);\n\t\t\tgetTTFB(onPerfEntry);\n\t\t});\n\t}\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}