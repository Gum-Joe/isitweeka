(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{13:function(e){e.exports=JSON.parse('{"events":[{"title":"Would I Lie To You?","ticketsURL":"https://www.eventbrite.co.uk/e/would-i-lie-to-you-students-vs-teachers-tickets-133890123965?aff=isitweeka","ticketsSale":{"start":"01/01/2020"},"headerURL":"/Logo_Export_Trans_but_not_on_HRT.png","backgroundColor":"#2C1F39","eventType":"charity"}],"generatedAt":"0"}')},29:function(e,t,n){},31:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n(1),r=n.n(i),s=n(10),c=n.n(s),o=(n(29),n(9)),u=n.n(o),l=n(11),d=n(5),h=n(6),b=n(8),j=n(7),f="ga-disable-G-X4VMSWGN74";function p(e){document.cookie=f+"=".concat(e?"true":"false","; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/"),window[f]=e}n(31);var v=n(18),k=n.n(v),O=n(13);function x(){window.scrollTo({top:window.innerHeight,behavior:"smooth"})}function w(){window.scrollTo({top:0,behavior:"smooth"})}var g=n(12),m=function(e){return Object(a.jsx)("button",Object(g.a)(Object(g.a)({},e),{},{className:"forward",children:Object(a.jsx)("span",{children:e.children})}))};m.displayName="Button.Forward";var y,D=m,C={backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",display:"flex",flex:1,margin:"auto",width:"90%",maxHeight:"80%"},S=function(e){Object(b.a)(n,e);var t=Object(j.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(a.jsxs)("div",{className:"events-row",style:{backgroundColor:this.props.background},children:[Object(a.jsx)("div",{children:Object(a.jsx)("div",{style:Object(g.a)({backgroundImage:"url(".concat(this.props.imageURL,")")},C)})}),Object(a.jsxs)("div",{children:[Object(a.jsx)("h3",{children:this.props.title}),new Date(this.props.saleDate).valueOf()<Date.now()?Object(a.jsx)("a",{href:this.props.ticketsURL,children:Object(a.jsx)(D,{children:"Buy Tickets"})}):null,Object(a.jsxs)("h4",{children:["Tickets on sale ",this.props.saleDate]})]})]})}}]),n}(r.a.PureComponent);!function(e){e.HOUSE="house",e.CHARITY="charity"}(y||(y={}));(new Date).toISOString();var T=function(e){Object(b.a)(n,e);var t=Object(j.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(a.jsxs)("div",{className:"isitweeka events",children:[Object(a.jsxs)("h2",{children:[Object(a.jsx)("button",{onClick:w,className:"back"})," Upcoming Events"]}),Object(a.jsx)("div",{className:"events-list",children:this.props.eventData.events.map((function(e,t){var n=e.title,i=e.headerURL,r=e.backgroundColor,s=e.ticketsSale,c=e.ticketsURL;return Object(a.jsx)(S,{imageURL:i,title:n,saleDate:s.start,ticketsURL:c,background:r},t)}))})]})}}]),n}(i.Component),R=n(19),N=function(e){Object(b.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).state={isNotWeekAB:!1,week:"unknown",apiHasRan:!1,isWeekend:!1,eventData:{events:[],generatedAt:""}},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){try{this.getCalendar(),this.fetchEvents()}catch(e){console.error("Error: "+(null===e||void 0===e?void 0:e.message))}}},{key:"fetchEvents",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({eventData:O});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMonday",value:function(e){var t=new Date(e),n=t.getDay(),a=t.getDate()-n+(6===n?8:1);return new Date(t.setDate(a))}},{key:"forwardOrRewindToDay",value:function(e,t,n){var a=new Date(e),i=a.getDay(),r=a.getDate()-i+t+(n.includes(i)?7:0);return new Date(a.setDate(r))}},{key:"getCalendar",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,a,i,r,s,c,o,l,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,(n=this.forwardOrRewindToDay(t,this.props.weekMarkerDate,[0,6])).setUTCHours(0,0,0,0),(a=new Date(n)).setDate(a.getDate()+1),a.setUTCHours(0,0,0,0),6!==(i=t.getDay())&&0!==i||this.setState({isWeekend:!0}),r=n.toISOString(),a.toISOString(),e.next=12,fetch(this.props.calendarURL,{method:"GET",mode:"no-cors",credentials:"same-origin"});case 12:return s=e.sent,e.next=15,s.text();case 15:if(c=e.sent,o=R.parseICS(c),(l=new Map(Object.entries(o))).forEach((function(e,t){var n;(null===(n=e.start)||void 0===n?void 0:n.toISOString())!==r&&l.delete(t)})),l.forEach((function(e,t){"Week A"===e.summary||"Week B"===e.summary?d=e:l.delete(t)})),0!==l.size&&d){e.next=24;break}this.setState({isNotWeekAB:!0,week:"unknown",apiHasRan:!0}),e.next=33;break;case 24:e.t0=d.summary,e.next="Week A"===e.t0?27:"Week B"===e.t0?29:31;break;case 27:return this.setState({week:"A",apiHasRan:!0}),e.abrupt("break",33);case 29:return this.setState({week:"B",apiHasRan:!0}),e.abrupt("break",33);case 31:return this.setState({isNotWeekAB:!0,apiHasRan:!0}),e.abrupt("break",33);case 33:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getStatus",value:function(){return this.state.isNotWeekAB||"unknown"===this.state.week?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{children:"It is neither Week A nor B."}),Object(a.jsx)("h3",{children:"This means it's probably a holiday."}),Object(a.jsx)(D,{style:{marginRight:"auto"},className:"forward",onClick:x,children:Object(a.jsx)("div",{children:"events"})}),Object(a.jsxs)("h5",{children:["If you believe this is in error, please email\xa0",Object(a.jsx)("a",{href:"mailto:info@isitweeka.com",children:"info@isitweeka.com"})]})]}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{children:this.state.isWeekend?"Next week will be":"It is"})," ",Object(a.jsxs)("h1",{children:["Week ",this.state.week]}),Object(a.jsx)("h4",{children:"More coming soon..."}),Object(a.jsx)(D,{style:{marginRight:"auto"},className:"forward",onClick:x,children:"events"})]})}},{key:"render",value:function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"isitweeka isitweeka-jumbotron",children:this.state.apiHasRan?this.getStatus():Object(a.jsx)("h2",{children:"Loading..."})}),Object(a.jsx)(T,{eventData:this.state.eventData})]})}}]),n}(i.Component),B=n(23),E=function(e){return Object(a.jsx)("div",{className:"r-tab-row",children:e.children})},H=function(e){return Object(a.jsx)("button",{className:"r-tab".concat(e.active?" active":""),onClick:e.onClick,children:Object(a.jsx)("span",{children:e.children})})},I=function(e){var t=r.a.useState(e.initialTab||0),n=Object(B.a)(t,2),i=n[0],s=n[1];function c(t,n){"undefined"!==typeof e.onTabChange&&e.onTabChange(t,n)}return r.a.useEffect((function(){return c(e.tabs[i].tab,i)})),Object(a.jsxs)("div",{className:"r-tab-container",children:[Object(a.jsx)(E,{children:e.tabs.map((function(e,t){var n=e.tab;return Object(a.jsx)(H,{onClick:function(){s(t),c(n,t)},active:i===t,children:n},t)}))}),Object(a.jsx)("div",{children:e.tabs.map((function(e,t){var n=e.component;return t===i?Object(a.jsx)("div",{children:n},t):null}))})]})},L=n(41),U=n(14),A=n.n(U),W="SchoolPreference",M=function(e){Object(b.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).state={eventData:{events:[],generatedAt:""}},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.fetchEvents()}},{key:"fetchEvents",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({eventData:O});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCookie",value:function(e,t){"true"===A.a.get("CookieConsent")&&(A.a.set(W,{school:e,tabIndex:t},{secure:!0,sameSite:"strict"}),"undefined"!==typeof gtag&&(console.log("Setting to "+e),gtag("set","user_properties",{school:e})))}},{key:"render",value:function(){return Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(I,{tabs:[{tab:"KECHB",component:Object(a.jsx)(N,{calendarURL:"/cal/KECHB/basic.ics",weekMarkerDate:1})},{tab:"KECHG",component:Object(a.jsx)(N,{calendarURL:"/cal/KECHG/basic.ics",weekMarkerDate:0})}],onTabChange:this.updateCookie,initialTab:function(){var e;return(null===(e=A.a.getJSON(W))||void 0===e?void 0:e.tabIndex)||0}()}),Object(a.jsx)(L.a,{fixed:"bottom",children:Object(a.jsxs)(k.a,{enableDeclineButton:!0,flipButtons:!0,buttonText:"I understand",declineButtonText:"No thanks",onAccept:function(){p(!1),window.location.reload()},onDecline:function(){p(!0),window.location.reload()},children:["This website uses cookies for preferences and analytics (via Google Analytics).",Object(a.jsx)("a",{href:"/privacy.html",children:" View Privacy Policy"})]})})]})}}]),n}(i.Component),F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,42)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),i(e),r(e),s(e)}))};c.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(M,{})}),document.getElementById("root")),F()}},[[37,1,2]]]);
//# sourceMappingURL=main.8cc66933.chunk.js.map