{"version":3,"sources":["App.tsx","reportWebVitals.ts","index.tsx"],"names":["API_KEY","App","props","state","gapiReady","isNotWeekAB","week","apiHasRan","isWeekend","this","loadGoogleAPI","script","document","createElement","src","async","defer","onload","window","gapi","load","client","setApiKey","setState","getCalendar","err","console","error","message","body","appendChild","d","dhere","Date","day","getDay","diff","getDate","setDate","inputDate","weekStart","getMonday","setUTCHours","weekEnd","dayNow","startTime","toISOString","endTime","calendarId","userTimeZone","init","clientId","calendar","events","list","timeMax","response","result","items","eventsToday","filter","entry","summary","length","theEvent","href","className","getStatus","Component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.0d24b11d.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\n\n/*function App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <p>\n          Edit <code>src/App.tsx</code> and save to reload.\n        </p>\n        <a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Learn React\n        </a>\n      </header>\n    </div>\n  );\n}*/\n\nconst API_KEY = 'AIzaSyBJtspfBiYYXzpF3Nc32owjtjnJbRToxK4';\nconst CLIENT_ID = \"315952430187-dnr3c50ojube21n64i1a85jr8l8787pq.apps.googleusercontent.com\"  \n\ninterface TheState {\n  /** Used to see whether the API has been loaded */\n  gapiReady: boolean;\n  /** Set to true if neither Week A or B is detected */\n  isNotWeekAB: boolean;\n  week: \"A\" | \"B\" | \"unknown\";\n  /** Tells page when API has ran  (i.e. page loaded) */\n  apiHasRan: boolean;\n  isWeekend: boolean;\n}\n\nclass App extends Component<{}, TheState> {\n\n  constructor(props: {}) {\n    super(props);\n    this.state = {\n      gapiReady: false,\n      isNotWeekAB: false,\n      week: \"unknown\",\n      apiHasRan : false,\n      isWeekend: false,\n    }\n  }\n\n  componentDidMount() {\n    this.loadGoogleAPI();\n  }\n\n  /**\n   * Loads the Google API, then runs {@link getCalendar}\n   */\n  loadGoogleAPI() {\n    const script = document.createElement(\"script\");\n    script.src = \"https://apis.google.com/js/client.js\";\n    script.async = true;\n    script.defer = true;\n\n    script.onload = () => {\n      window.gapi.load(\"client\", () => {\n        window.gapi.client.setApiKey(API_KEY);\n        window.gapi.client.load(\"calendar\", \"v3\", () => {\n          this.setState({ gapiReady: true });\n          try {\n            this.getCalendar();\n          } catch (err) {\n            console.error(\"Error: \" + err?.message)\n          }\n        });\n      });\n    };\n\n    document.body.appendChild(script);\n  }\n\n  /**\n   * Gets the monday from a week\n   * From https://stackoverflow.com/questions/4156434/javascript-get-the-first-day-of-the-week-from-current-date\n   */\n  getMonday(d: Date) {\n    const dhere = new Date(d);\n    const day = dhere.getDay();\n    // Sunday is day 0\n    // Sat is Day 6\n    // If Sun or Sat go to next week\n    /**\n     * What this does is:\n     * - Take the current date\n     * - Subtract the day of the week, taking us to the previous Sunday\n     * - Go forward one to monday\n     * - BUT if the current date is a Saturday, add 8 instead as we want 2 days after that Saturday (the next week), not the previous Monday\n     */\n    const diff = dhere.getDate() - day + (day === 6 ? 8 : 1); // adjust when day is saturday -> add 6 to bring us back to Saturday, then add 2 to go to Monday\n    return new Date(dhere.setDate(diff));\n  }\n\n  /**\n   * Loads the KECHB calendar, finds the current week, then goes to the Monday of that week and checks for a Week A or Week B event.\n   */\n  async getCalendar() {\n\n    const inputDate = new Date();\n    // Used for fiddling:\n    // inputDate.setDate(2);\n    // inputDate.setMonth(0);\n    // inputDate.setFullYear(2021);\n    const weekStart = this.getMonday(inputDate);\n    weekStart.setUTCHours(0, 0, 0, 0); // Set to start of day\n    const weekEnd = new Date(weekStart);\n    weekEnd.setDate(weekEnd.getDate() + 1)\n    weekEnd.setUTCHours(0, 0, 0, 0); // Set to start of day\n\n    // Tell us if weekend!\n    const dayNow = inputDate.getDay();\n    if (dayNow === 6 || dayNow === 0) { // 0 is Sunday, 6 is Saturday\n      this.setState({\n        isWeekend: true,\n      })\n    } \n\n\n    const startTime = weekStart.toISOString()\n    const endTime = weekEnd.toISOString();\n    \n    // The \"Calendar ID\" from your calendar settings page, \"Calendar Integration\" secion:\n    const calendarId = 'calendar@camphillboys.bham.sch.uk';\n\n    // 1. Create a project using google's wizzard: https://console.developers.google.com/start/api?id=calendar\n    // 2. Create credentials:\n    //    a) Go to https://console.cloud.google.com/apis/credentials\n    //    b) Create Credentials / API key\n    //    c) Since your key will be called from any of your users' browsers, set \"Application restrictions\" to \"None\",\n    //       leave \"Website restrictions\" blank; you may optionally set \"API restrictions\" to \"Google Calendar API\"\n    \n    // You can get a list of time zones from here: http://www.timezoneconverter.com/cgi-bin/zonehelp\n    const userTimeZone = \"Europe/London\";\n\n    // Initializes the client with the API key and the Translate API.\n    await window.gapi.client.init({\n      'apiKey': API_KEY,\n      clientId: CLIENT_ID,\n      // Discovery docs docs: https://developers.google.com/api-client-library/javascript/features/discovery\n      'discoveryDocs': ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest'],\n    })\n    const response = await gapi.client.calendar.events.list({\n      'calendarId': calendarId,\n      'timeZone': userTimeZone,\n      'singleEvents': true,\n      'timeMin': (new Date(startTime)).toISOString(),\n      timeMax: (new Date(endTime)).toISOString(),\n      'maxResults': 20,\n      'orderBy': 'startTime'\n    });\n    if (response.result.items) {\n      const calendarRows = ['<table class=\"wellness-calendar\"><tbody>'];\n      // Filter events to those that are \"Week A\" or \"Week B\"\n      const eventsToday = response.result.items.filter(entry => entry.summary === \"Week A\" || entry.summary === \"Week B\");\n      if (eventsToday.length === 0) {\n        // Neithe detected.  Probably Hols.\n        this.setState({\n          isNotWeekAB: true,\n          week: \"unknown\",\n          apiHasRan: true,\n        })\n      } else {\n        const theEvent = eventsToday[0];\n        switch (theEvent.summary) {\n          case \"Week A\":\n            this.setState({\n              week: \"A\",\n              apiHasRan: true,\n            });\n            break;\n          case \"Week B\":\n            this.setState({\n              week: \"B\",\n              apiHasRan: true,\n            });\n            break;\n          default:\n            // NEITHER!\n            // Something went wrong\n            this.setState({\n              isNotWeekAB: true,\n              apiHasRan: true,\n            })\n            break;\n        }\n      }\n    }\n  }\n\n  getStatus() {\n    if (this.state.isNotWeekAB || this.state.week === \"unknown\") {\n      return (\n        <>\n          <h2>It is neither Week A or B.</h2>\n          <h3>This means it's probably a holiday.</h3>\n          <h4>If you believe this is in error, please email <a href=\"mailto:info@isitweeka.com\">info@isitweeka.com</a></h4>\n        </>\n      )\n    } else {\n      return (\n        <>\n          <h2>{this.state.isWeekend ? \"Next week will be\" : \"It is\"}</h2> {/* Special case for weekend, where we show next week*/}\n          <h1>Week {this.state.week}</h1>\n          <h4>More coming soon...</h4>\n        </>\n      )\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <div className=\"isitweeka\">\n          {\n            this.state.apiHasRan ? this.getStatus() : ( <h1>Loading...</h1> )\n          }\n          {/*<h2>It is</h2>\n          <h1>Week A/B</h1>\n          <h3>More coming soon</h3>\n          <h2>isitweeka.com</h2>\n          <h1>IT BEGINS.</h1>\n          <h3>More coming soon</h3>*/}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}